---
title: "Entrega1"
autor: "Ángel García, Arnau Piferrer, Guillem Serra"
format: html
editor: visual
---

Este es el [repositorio](https://github.com/GSMir/Entrega1.git) dónde se puede encontrar todo el trabajo realizado en este proyecto.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r cargar-librerias}
#install.packages("palmerpenguins",dep=TRUE)
library("palmerpenguins")
```

```{r}
nvariables = length(penguins)
nobservaciones = nrow(penguins)
```


Hay `r nobservaciones` observaciones de pingüinos, y `r nvariables` variables diferentes.

## Vamos a estudiar cada una de las variables:

Primero de todo veamos que variables tenemos
```{r}
ls(penguins)
```
Ahora hagamos un estudio de cada una de las variables.


### Species

```{r}
clasevariable = class(penguins$species)
```

Es una variable del tipo ´r clasevariable´. Hace referéncia la espécie del pingüino.

```{r}
summary(penguins$species)
```
Podemos observar que hay 3 espécies diferentes, "Adelie", "Chinstrap" y "Gentoo". 

### Island

```{r}
clasevariable = class(penguins$island)
```

Es una variable del tipo ´r clasevariable´. Hace referéncia a la isla en la que viven los pingüinos

```{r}
summary(penguins$island)
```
Podemos observar que hay 3 islas diferentes, "Biscoe", "Dream" y "Torgersen".

### Bill_length_mm

```{r}
clasevariable = class(penguins$bill_length_mm)
```

Es una variable del tipo ´r clasevariable´.

```{r}
summary(penguins$bill_length_mm)
desviacion = sd(na.omit(penguins$bill_length_mm))
```
Hace referéncia a la longitud del pico de los pingüinos, en mm. Va en un rango de 32.1mm a 59.6mm. Con una media de 43.92mm, con 44.45mm de mediana, y una desviación típica de `r round(desviacion, 2)`.

### Bill_depth_mm

```{r}
clasevariable = class(penguins$bill_depth_mm)
```

Es una variable del tipo ´r clasevariable´.

```{r}
summary(penguins$bill_depth_mm)
desviacion = sd(na.omit(penguins$bill_depth_mm))
```

Hace referéncia a la amplitud del pico de los pingüinos, en mm. Va en un rango de 13.1mm a 21.5mm. Con una media de 17.15mm, con 17.30mm de mediana y una desviación típica de `r round(desviacion, 2)`.

### Flipper_length_mm

```{r}
clasevariable = class(penguins$flipper_length_mm)
```

Es una variable del tipo ´r clasevariable´.

```{r}
summary(penguins$flipper_length_mm)
desviacion = sd(na.omit(penguins$flipper_length_mm))
```

Hace referéncia a la longitud de las aletas de los pingüinos, en mm. Va en un rango de 172.0mm a 231.0mm. Con una media de 200.9mm, con 197mm de mediana y una desviación típica de `r round(desviacion, 2)`.



### Body_mass_g

```{r}
clasevariable = class(penguins$body_mass_g)
```

Es una variable del tipo ´r clasevariable´.

```{r}
summary(penguins$body_mass_g)
desviacion = sd(na.omit(penguins$body_mass_g))
```

Hace referéncia al peso de los pingüinos, en g. Va en un rango de 2700g a 6300g. Con una media de 4202g, con 4050g de mediana y una desviación típica de `r round(desviacion, 2)`.

### Sex

```{r}
clasevariable = class(penguins$sex)
```

Es una variable del tipo ´r clasevariable´. Hace referéncia al sexo cromosómico de los pingüinos.

```{r}
summary(penguins$sex)
```
Podemos observar que hay 165 observaciones de hembras, y 168 observaciones de machos. 

### Year

```{r}
clasevariable = class(penguins$year)
```

Es una variable del tipo ´r clasevariable´. Hace referéncia al año en que nacieron los pingüinos. Observemso que esta variable tendría más sentido tratarla como factor, y para ejectura el summary lo trataremos como tal.

```{r}
summary(as.factor(penguins$year))
```
Podemos observar que los pingüinos, del estudio, nacieron en 3 años diferentes; 2007, 2008, 2009.



## Veamos ahora algunos gráficos:

```{r}
par(mfrow=c(1,4), mar=c(0,1,2,1))

nAdelie = length(which(penguins$species == "Adelie"))
nChinstrap = length(which(penguins$species == "Chinstrap"))
nGentoo = length(which(penguins$species == "Gentoo"))
slices = c(nAdelie, nChinstrap, nGentoo)
lbls = c(nAdelie, nChinstrap, nGentoo)

pie(slices, main = "Espécie", labels = lbls, col = c("deepskyblue", "darkorange", "chartreuse3"))
legend("top", c("Adelie", "Chinstrap", "Gentoo"), cex = 1, fill = c("deepskyblue", "darkorange", "chartreuse3"))


nBiscoe = length(which(penguins$island == "Biscoe"))
nDream = length(which(penguins$island == "Dream"))
nTorgersen = length(which(penguins$island == "Torgersen"))
slices = c(nBiscoe, nDream, nTorgersen)
lbls = c(nBiscoe, nDream, nTorgersen)

pie(slices, main = "Isla", labels = lbls, col = c("deepskyblue", "darkorange", "chartreuse3"))
legend("top", c("Biscoe", "Dream", "Torgersen"), cex = 1, fill = c("deepskyblue", "darkorange", "chartreuse3"))


nFemale = length(which(penguins$sex == "female"))
nMale = length(which(penguins$sex == "male"))
slices = c(nFemale, nMale)
lbls = c(nFemale, nMale)

pie(slices, main = "Sexo", labels = lbls, col = c("deepskyblue", "darkorange"))
legend("top", c("Hembra", "Macho"), cex = 1, fill = c("deepskyblue", "darkorange"))


n2007 = length(which(penguins$year == "2007"))
n2008 = length(which(penguins$year == "2008"))
n2009 = length(which(penguins$year == "2009"))
slices = c(n2007, n2008, n2009)
lbls = c(n2007, n2008, n2009)

pie(slices, main = "Año de nacimiento", labels = lbls, col = c("deepskyblue", "darkorange", "chartreuse3"))
legend("top", c("2007", "2008", "2009"), cex = 1, fill = c("deepskyblue", "darkorange", "chartreuse3"))
```


## Estudio inferencial

### Media de la longitud de los picos


Vamos a hacer un boxplot para comprobar si hay diferencias significativas entre las medias de las longitudes de los picos en referencia a las especies de pingüinos.

```{r}
boxplot(penguins$bill_length_mm~penguins$species,ylab = "Longitud del pico",xlab = "Especies")
```
Observamos que la mediana de Adelie es bastante más pequeña que el resto, vamos a comprobarlo mediante un t.test.

```{r}
t.test(penguins$bill_length_mm[penguins$species=="Adelie"],penguins$bill_length_mm[penguins$species=="Gentoo"],conf.level = 0.95,alternative = "less",paired = FALSE,var.equal = FALSE)

t.test(penguins$bill_length_mm[penguins$species=="Adelie"],penguins$bill_length_mm[penguins$species=="Chinstrap"],conf.level = 0.95,alternative = "less",paired = FALSE,var.equal = FALSE)

```
Podemos observar que los dos t.test nos sale un p-valor mas pequeño que 0.05, por lo tanto podemos afirmar la hipótesis inicial; la media de longitud de los picos de la especia "Adelie" es más pequeña que la de las otras dos.

Ahora vamos a observar si hay diferencias significativas de la longitud del pico entre una misma especie y las islas donde habitan. Primero vamos a comprobar en que islas viven las diferentes especies de pingüinos.


```{r}
table(penguins$island[penguins$species=="Adelie"])
table(penguins$island[penguins$species=="Gentoo"])
table(penguins$island[penguins$species=="Chinstrap"])
```
Observamos que la única especie que habita en más de una isla es la "Adelie", por lo tanto realizamos un boxplot de las longitudes del pico centrándonos en esa especie y las islas donde habitan.

```{r}
boxplot(penguins$bill_length_mm[penguins$species=="Adelie"]~penguins$island[penguins$species=="Adelie"],ylab = "Longitud del pico de Adelie",xlab = "Islas")
```

No podemos obervar diferencias significativas.







```{r, echo=FALSE}
par(mfrow=c(1,3), mar=c(0,1.5,2,1.5))

islandBiscoe=length(which(penguins$island=="Biscoe" & penguins$species=="Adelie"))
islandDream=length(which(penguins$island=="Dream" & penguins$species=="Adelie"))
islandTorgersen=length(which(penguins$island=="Torgersen" & penguins$species=="Adelie"))
slices = c(islandBiscoe, islandDream, islandTorgersen)

pie(slices, main="Adelie", labels="",col=c("deepskyblue", "darkorange", "chartreuse3"))
legend("top", c("Biscoe", "Dream", "Torgersen"),cex=1, fill=c("deepskyblue", "darkorange", "chartreuse3"))


islandBiscoe=length(which(penguins$island=="Biscoe" & penguins$species=="Chinstrap"))
islandDream=length(which(penguins$island=="Dream" & penguins$species=="Chinstrap"))
islandTorgersen=length(which(penguins$island=="Torgersen" & penguins$species=="Chinstrap"))
slices = c(islandBiscoe, islandDream, islandTorgersen)

pie(slices, main="Chinstrap",labels="",col=c("deepskyblue", "darkorange", "chartreuse3"))
legend("top", c("Biscoe", "Dream", "Torgersen"),cex=1, fill=c("deepskyblue", "darkorange", "chartreuse3"))


islandBiscoe=length(which(penguins$island=="Biscoe" & penguins$species=="Gentoo"))
islandDream=length(which(penguins$island=="Dream" & penguins$species=="Gentoo"))
islandTorgersen=length(which(penguins$island=="Torgersen" & penguins$species=="Gentoo"))
slices = c(islandBiscoe, islandDream, islandTorgersen)

pie(slices, main="Gentoo",labels="",col=c("deepskyblue", "darkorange", "chartreuse3"))
legend("top", c("Biscoe", "Dream", "Torgersen"),cex=1, fill=c("deepskyblue", "darkorange", "chartreuse3"))
```





